<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="一、Pandas介绍在处理实际的金融数据时，一个条数据通常包含了多种类型的数据，例如，股票的代码是字符串，收盘价是浮点型，而成交量是整型等。在C++中可以实现为一个给定结构体作为单元的容器，如向量（vector，C++中的特定数据结构）。在Python中，pandas包含了高级的数据结构Series和DataFrame，使得在Python中处理数据变得非常方便、快速和简单。pandas不同的版本之">
<meta property="og:type" content="article">
<meta property="og:title" content="pandas">
<meta property="og:url" content="https://chenwi.github.io/2018/05/20/pandas/index.html">
<meta property="og:site_name" content="Mr番茄蛋的博客">
<meta property="og:description" content="一、Pandas介绍在处理实际的金融数据时，一个条数据通常包含了多种类型的数据，例如，股票的代码是字符串，收盘价是浮点型，而成交量是整型等。在C++中可以实现为一个给定结构体作为单元的容器，如向量（vector，C++中的特定数据结构）。在Python中，pandas包含了高级的数据结构Series和DataFrame，使得在Python中处理数据变得非常方便、快速和简单。pandas不同的版本之">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://img-blog.csdn.net/20180507194213523?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180507194528949?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180507194926432?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180507195512903?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180507195723401?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:updated_time" content="2018-05-20T06:27:43.082Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="pandas">
<meta name="twitter:description" content="一、Pandas介绍在处理实际的金融数据时，一个条数据通常包含了多种类型的数据，例如，股票的代码是字符串，收盘价是浮点型，而成交量是整型等。在C++中可以实现为一个给定结构体作为单元的容器，如向量（vector，C++中的特定数据结构）。在Python中，pandas包含了高级的数据结构Series和DataFrame，使得在Python中处理数据变得非常方便、快速和简单。pandas不同的版本之">
<meta name="twitter:image" content="https://img-blog.csdn.net/20180507194213523?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://chenwi.github.io/2018/05/20/pandas/"/>





  <title>pandas | Mr番茄蛋的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mr番茄蛋的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chenwi.github.io/2018/05/20/pandas/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenwi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/_headimg/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr番茄蛋的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">pandas</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-20T14:21:41+08:00">
                2018-05-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="一、Pandas介绍"><a href="#一、Pandas介绍" class="headerlink" title="一、Pandas介绍"></a>一、Pandas介绍</h2><p>在处理实际的金融数据时，一个条数据通常包含了多种类型的数据，例如，股票的代码是字符串，收盘价是浮点型，而成交量是整型等。在C++中可以实现为一个给定结构体作为单元的容器，如向量（vector，C++中的特定数据结构）。在Python中，pandas包含了高级的数据结构Series和DataFrame，使得在Python中处理数据变得非常方便、快速和简单。pandas不同的版本之间存在一些不兼容性，为此，我们需要清楚使用的是哪一个版本的pandas。</p>
<h2 id="二、Pandas数据结构介绍"><a href="#二、Pandas数据结构介绍" class="headerlink" title="二、Pandas数据结构介绍"></a>二、Pandas数据结构介绍</h2><p>在pandas中有两类非常重要的数据结构，即序列Series和数据框DataFrame。Series类似于numpy中的一维数组，除了通吃一维数组可用的函数或方法，而且其可通过索引标签的方式获取数据，还具有索引的自动对齐功能；DataFrame类似于numpy中的二维数组，同样可以通用numpy数组的函数和方法，而且还具有其他灵活应用，后续会介绍到。</p>
<h3 id="1、Series的创建"><a href="#1、Series的创建" class="headerlink" title="1、Series的创建"></a>1、Series的创建</h3><p>Series的创建主要有三种方式：</p>
<p>1）通过一维数组创建序列<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">arr1 = np.arange(<span class="number">5</span>)</span><br><span class="line">print(arr1)</span><br><span class="line">print(type(arr1))</span><br><span class="line">s1 = pd.Series(arr1)</span><br><span class="line">print(s1)</span><br><span class="line">print(type(s1))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://img-blog.csdn.net/20180507194213523?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="运行结果"><br>2）通过字典的方式创建序列<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">arr1 = &#123;<span class="string">'a'</span>:<span class="number">10</span>,<span class="string">'b'</span>:<span class="number">20</span>,<span class="string">'c'</span>:<span class="number">30</span>,<span class="string">'d'</span>:<span class="number">40</span>,<span class="string">'e'</span>:<span class="number">50</span>&#125;</span><br><span class="line">print(arr1)</span><br><span class="line">print(type(arr1))</span><br><span class="line">s1 = pd.Series(arr1)</span><br><span class="line">print(s1)</span><br><span class="line">print(type(s1))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://img-blog.csdn.net/20180507194528949?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="运行结果"><br>3）通过DataFrame中的某一行或某一列创建序列，具体见DataFrame创建。</p>
<h3 id="2、DataFrame的创建"><a href="#2、DataFrame的创建" class="headerlink" title="2、DataFrame的创建"></a>2、DataFrame的创建</h3><p>数据框的创建主要有三种方式：</p>
<p>1）通过二维数组创建数据框</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">arr1 = np.array(np.arange(<span class="number">12</span>)).reshape(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">print(arr1)</span><br><span class="line">print(type(arr1))</span><br><span class="line">df1 = pd.DataFrame(arr1)</span><br><span class="line">print(df1)</span><br><span class="line">print(type(df1))</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdn.net/20180507194926432?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>2）通过字典的方式创建数据框<br>以下以两种字典来创建数据框，一个是字典列表，一个是嵌套字典。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">dic1 = &#123;<span class="string">'a'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'b'</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">        <span class="string">'c'</span>: [<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>], <span class="string">'d'</span>: [<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]&#125;</span><br><span class="line">print(dic1)</span><br><span class="line">print(type(dic1))</span><br><span class="line">df1 = pd.DataFrame(dic1)</span><br><span class="line">print(df1)</span><br><span class="line">print(type(df1))</span><br><span class="line"></span><br><span class="line">dic2 = &#123;<span class="string">'one'</span>: &#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>, <span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>&#125;,</span><br><span class="line">        <span class="string">'two'</span>: &#123;<span class="string">'a'</span>: <span class="number">5</span>, <span class="string">'b'</span>: <span class="number">6</span>, <span class="string">'c'</span>: <span class="number">7</span>, <span class="string">'d'</span>: <span class="number">8</span>&#125;,</span><br><span class="line">        <span class="string">'three'</span>: &#123;<span class="string">'a'</span>: <span class="number">9</span>, <span class="string">'b'</span>: <span class="number">10</span>, <span class="string">'c'</span>: <span class="number">11</span>, <span class="string">'d'</span>: <span class="number">12</span>&#125;&#125;</span><br><span class="line">print(dic2)</span><br><span class="line">print(type(dic2))</span><br><span class="line">df2 = pd.DataFrame(dic2)</span><br><span class="line">print(df2)</span><br><span class="line">print(type(df2))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://img-blog.csdn.net/20180507195512903?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>3）通过数据框的方式创建数据框<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df3=df2[[<span class="string">'one'</span>,<span class="string">'three'</span>]]</span><br><span class="line">print(df3)</span><br><span class="line">print(type(df3))</span><br><span class="line">s3 = df3[<span class="string">'one'</span>]</span><br><span class="line">print(s3)</span><br><span class="line">print(type(s3))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://img-blog.csdn.net/20180507195723401?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MjAzNDI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<h2 id="三、数据索引index"><a href="#三、数据索引index" class="headerlink" title="三、数据索引index"></a>三、数据索引index</h2><p>细致的朋友可能会发现一个现象，不论是序列也好，还是数据框也好，对象的最左边总有一个非原始数据对象，这个是什么呢？不错，就是我们接下来要介绍的索引。<br>在我看来，序列或数据框的索引有两大用处，一个是通过索引值或索引标签获取目标数据，另一个是通过索引，可以使序列或数据框的计算、操作实现自动化对齐，下面我们就来看看这两个功能的应用。</p>
<p>1、通过索引值或索引标签获取数据</p>
<p>如果不给序列一个指定的索引值，则序列自动生成一个从0开始的自增索引。可以通过index查看序列的索引：</p>
<p>s4.index<br>现在我们为序列设定一个自定义的索引值：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s4 = pd.Series(np.array([<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>]))</span><br><span class="line">print(s4)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="comment"># 0    1</span></span><br><span class="line"><span class="comment"># 1    1</span></span><br><span class="line"><span class="comment"># 2    2</span></span><br><span class="line"><span class="comment"># 3    3</span></span><br><span class="line"><span class="comment"># 4    5</span></span><br><span class="line"><span class="comment"># 5    8</span></span><br><span class="line"><span class="comment"># dtype: int32</span></span><br></pre></td></tr></table></figure></p>
<p>序列有了索引，就可以通过索引值或索引标签进行数据的获取：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s4[<span class="number">3</span>]</span><br><span class="line">s4[<span class="string">'e'</span>]</span><br><span class="line">s4[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]]</span><br><span class="line">s4[[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'d'</span>,<span class="string">'f'</span>]]</span><br><span class="line">s4[:<span class="number">4</span>]</span><br><span class="line">s4[<span class="string">'c'</span>:]</span><br><span class="line">s4[<span class="string">'b'</span>:<span class="string">'e'</span>]</span><br></pre></td></tr></table></figure></p>
<p>千万注意：如果通过索引标签获取数据的话，末端标签所对应的值是可以返回的！在一维数组中，就无法通过索引标签获取数据，这也是序列不同于一维数组的一个方面。</p>
<p>2、自动化对齐<br>如果有两个序列，需要对这两个序列进行算术运算，这时索引的存在就体现的它的价值了—自动化对齐.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">s5 = pd.Series(np.array([<span class="number">10</span>,<span class="number">15</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">55</span>,<span class="number">80</span>]),</span><br><span class="line">               index = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>])</span><br><span class="line">print(s5)</span><br><span class="line"><span class="comment"># a    10</span></span><br><span class="line"><span class="comment"># b    15</span></span><br><span class="line"><span class="comment"># c    20</span></span><br><span class="line"><span class="comment"># d    30</span></span><br><span class="line"><span class="comment"># e    55</span></span><br><span class="line"><span class="comment"># f    80</span></span><br><span class="line"><span class="comment"># dtype: int32</span></span><br><span class="line">s6 = pd.Series(np.array([<span class="number">12</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">16</span>]),</span><br><span class="line">               index = [<span class="string">'a'</span>,<span class="string">'c'</span>,<span class="string">'g'</span>,<span class="string">'b'</span>,<span class="string">'d'</span>,<span class="string">'f'</span>])</span><br><span class="line">print(s6)</span><br><span class="line"><span class="comment"># a    12</span></span><br><span class="line"><span class="comment"># c    11</span></span><br><span class="line"><span class="comment"># g    13</span></span><br><span class="line"><span class="comment"># b    15</span></span><br><span class="line"><span class="comment"># d    14</span></span><br><span class="line"><span class="comment"># f    16</span></span><br><span class="line"><span class="comment"># dtype: int32</span></span><br><span class="line"></span><br><span class="line">print(s5 + s6)</span><br><span class="line"><span class="comment"># a    22.0</span></span><br><span class="line"><span class="comment"># b    30.0</span></span><br><span class="line"><span class="comment"># c    31.0</span></span><br><span class="line"><span class="comment"># d    44.0</span></span><br><span class="line"><span class="comment"># e     NaN</span></span><br><span class="line"><span class="comment"># f    96.0</span></span><br><span class="line"><span class="comment"># g     NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line">print(s5/s6)</span><br><span class="line"><span class="comment"># a    0.833333</span></span><br><span class="line"><span class="comment"># b    1.000000</span></span><br><span class="line"><span class="comment"># c    1.818182</span></span><br><span class="line"><span class="comment"># d    2.142857</span></span><br><span class="line"><span class="comment"># e         NaN</span></span><br><span class="line"><span class="comment"># f    5.000000</span></span><br><span class="line"><span class="comment"># g         NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br></pre></td></tr></table></figure></p>
<p>由于s5中没有对应的g索引，s6中没有对应的e索引，所以数据的运算会产生两个缺失值NaN。注意，这里的算术结果就实现了两个序列索引的自动对齐，而非简单的将两个序列加总或相除。对于数据框的对齐，不仅仅是行索引的自动对齐，同时也会自动对齐列索引（变量名）</p>
<p>数据框中同样有索引，而且数据框是二维数组的推广，所以其不仅有行索引，而且还存在列索引，关于数据框中的索引相比于序列的应用要强大的多，这部分内容将放在数据查询中讲解。</p>
<h2 id="四、利用pandas查询数据"><a href="#四、利用pandas查询数据" class="headerlink" title="四、利用pandas查询数据"></a>四、利用pandas查询数据</h2><p>这里的查询数据相当于R语言里的subset功能，可以通过布尔索引有针对的选取原数据的子集、指定行、指定列等。我们先导入一个student数据集：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">student = pd.io.parsers.read_csv(<span class="string">'C:\\Users\\admin\\Desktop\\student.csv'</span>)</span><br><span class="line"><span class="comment"># 查询数据的前5行或末尾5行</span></span><br><span class="line"></span><br><span class="line">student.head()</span><br><span class="line">student.tail()</span><br><span class="line"><span class="comment"># 查询指定的行</span></span><br><span class="line"></span><br><span class="line">student.ix[[<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>]] <span class="comment">#这里的ix索引标签函数必须是中括号[]</span></span><br><span class="line"><span class="comment"># 查询指定的列</span></span><br><span class="line"></span><br><span class="line">student[[<span class="string">'Name'</span>,<span class="string">'Height'</span>,<span class="string">'Weight'</span>]].head()  <span class="comment">#如果多个列的话，必须使用双重中括号</span></span><br><span class="line"><span class="comment"># 也可以通过ix索引标签查询指定的列</span></span><br><span class="line"></span><br><span class="line">student.ix[:,[<span class="string">'Name'</span>,<span class="string">'Height'</span>,<span class="string">'Weight'</span>]].head()</span><br><span class="line"><span class="comment"># 查询指定的行和列</span></span><br><span class="line"></span><br><span class="line">student.ix[[<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>],[<span class="string">'Name'</span>,<span class="string">'Height'</span>,<span class="string">'Weight'</span>]].head()</span><br><span class="line"><span class="comment"># 以上是从行或列的角度查询数据的子集，现在我们来看看如何通过布尔索引实现数据的子集查询。</span></span><br><span class="line"><span class="comment"># 查询所有女生的信息</span></span><br><span class="line"></span><br><span class="line">student[student[<span class="string">'Sex'</span>]==<span class="string">'F'</span>]</span><br><span class="line"><span class="comment"># 查询出所有12岁以上的女生信息</span></span><br><span class="line"></span><br><span class="line">student[(student[<span class="string">'Sex'</span>]==<span class="string">'F'</span>) &amp; (student[<span class="string">'Age'</span>]&gt;<span class="number">12</span>)]</span><br><span class="line">查询出所有<span class="number">12</span>岁以上的女生姓名、身高和体重</span><br><span class="line"></span><br><span class="line">student[(student[<span class="string">'Sex'</span>]==<span class="string">'F'</span>) &amp; (student[<span class="string">'Age'</span>]&gt;<span class="number">12</span>)][[<span class="string">'Name'</span>,<span class="string">'Height'</span>,<span class="string">'Weight'</span>]]</span><br></pre></td></tr></table></figure>
<p>上面的查询逻辑其实非常的简单，需要注意的是，如果是多个条件的查询，必须在&amp;（且）或者|（或）的两端条件用括号括起来。</p>
<h2 id="五、统计分析"><a href="#五、统计分析" class="headerlink" title="五、统计分析"></a>五、统计分析</h2><p>pandas模块为我们提供了非常多的描述性统计分析的指标函数，如总和、均值、最小值、最大值等，我们来具体看看这些函数：<br>首先随机生成三组数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">1234</span>)</span><br><span class="line">d1 = pd.Series(<span class="number">2</span>*np.random.normal(size = <span class="number">100</span>)+<span class="number">3</span>)</span><br><span class="line">d2 = np.random.f(<span class="number">2</span>,<span class="number">4</span>,size = <span class="number">100</span>)</span><br><span class="line">d3 = np.random.randint(<span class="number">1</span>,<span class="number">100</span>,size = <span class="number">100</span>)</span><br><span class="line">d1.count()  <span class="comment">#非空元素计算</span></span><br><span class="line">d1.min()    <span class="comment">#最小值</span></span><br><span class="line">d1.max()    <span class="comment">#最大值</span></span><br><span class="line">d1.idxmin() <span class="comment">#最小值的位置，类似于R中的which.min函数</span></span><br><span class="line">d1.idxmax() <span class="comment">#最大值的位置，类似于R中的which.max函数</span></span><br><span class="line">d1.quantile(<span class="number">0.1</span>)    <span class="comment">#10%分位数</span></span><br><span class="line">d1.sum()    <span class="comment">#求和</span></span><br><span class="line">d1.mean()   <span class="comment">#均值</span></span><br><span class="line">d1.median() <span class="comment">#中位数</span></span><br><span class="line">d1.mode()   <span class="comment">#众数</span></span><br><span class="line">d1.var()    <span class="comment">#方差</span></span><br><span class="line">d1.std()    <span class="comment">#标准差</span></span><br><span class="line">d1.mad()    <span class="comment">#平均绝对偏差</span></span><br><span class="line">d1.skew()   <span class="comment">#偏度</span></span><br><span class="line">d1.kurt()   <span class="comment">#峰度</span></span><br><span class="line">d1.describe()   <span class="comment">#一次性输出多个描述性统计指标</span></span><br></pre></td></tr></table></figure></p>
<p>必须注意的是，descirbe方法只能针对序列或数据框，一维数组是没有这个方法的。<br>这里自定义一个函数，将这些统计描述指标全部汇总到一起:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stats</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> pd.Series([x.count(),x.min(),x.idxmin(),</span><br><span class="line">               x.quantile(<span class="number">.25</span>),x.median(),</span><br><span class="line">               x.quantile(<span class="number">.75</span>),x.mean(),</span><br><span class="line">               x.max(),x.idxmax(),</span><br><span class="line">               x.mad(),x.var(),</span><br><span class="line">               x.std(),x.skew(),x.kurt()],</span><br><span class="line">              index = [<span class="string">'Count'</span>,<span class="string">'Min'</span>,<span class="string">'Whicn_Min'</span>,</span><br><span class="line">                       <span class="string">'Q1'</span>,<span class="string">'Median'</span>,<span class="string">'Q3'</span>,<span class="string">'Mean'</span>,</span><br><span class="line">                       <span class="string">'Max'</span>,<span class="string">'Which_Max'</span>,<span class="string">'Mad'</span>,</span><br><span class="line">                       <span class="string">'Var'</span>,<span class="string">'Std'</span>,<span class="string">'Skew'</span>,<span class="string">'Kurt'</span>])</span><br><span class="line">stats(d1)</span><br></pre></td></tr></table></figure>
<p>在实际的工作中，我们可能需要处理的是一系列的数值型数据框，如何将这个函数应用到数据框中的每一列呢？可以使用apply函数，这个非常类似于R中的apply的应用方法。<br>将之前创建的d1,d2,d3数据构建数据框:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.array([d1,d2,d3]).T,columns=[<span class="string">'x1'</span>,<span class="string">'x2'</span>,<span class="string">'x3'</span>])</span><br><span class="line">df.head()</span><br><span class="line">df.apply(stats)</span><br></pre></td></tr></table></figure>
<p>非常完美，就这样很简单的创建了数值型数据的统计性描述。如果是离散型数据呢？就不能用这个统计口径了，我们需要统计离散变量的观测数、唯一值个数、众数水平及个数。你只需要使用describe方法就可以实现这样的统计了。<br>student[‘Sex’].describe()</p>
<p>除以上的简单描述性统计之外，还提供了连续变量的相关系数（corr）和协方差矩阵（cov）的求解，这个跟R语言是一致的用法。<br>df.corr()</p>
<p>关于相关系数的计算可以调用pearson方法或kendell方法或spearman方法，默认使用pearson方法。<br>df.corr(‘spearman’)</p>
<p>如果只想关注某一个变量与其余变量的相关系数的话，可以使用corrwith,如下方只关心x1与其余变量的相关系数:<br>df.corrwith(df[‘x1’])</p>
<p>数值型变量间的协方差矩阵<br>df.cov()</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/19/gooday/" rel="next" title="gooday">
                <i class="fa fa-chevron-left"></i> gooday
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/_headimg/head.jpg"
                alt="chenwi" />
            
              <p class="site-author-name" itemprop="name">chenwi</p>
              <p class="site-description motion-element" itemprop="description">生命不息，奋斗不止！</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、Pandas介绍"><span class="nav-number">1.</span> <span class="nav-text">一、Pandas介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、Pandas数据结构介绍"><span class="nav-number">2.</span> <span class="nav-text">二、Pandas数据结构介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、Series的创建"><span class="nav-number">2.1.</span> <span class="nav-text">1、Series的创建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、DataFrame的创建"><span class="nav-number">2.2.</span> <span class="nav-text">2、DataFrame的创建</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、数据索引index"><span class="nav-number">3.</span> <span class="nav-text">三、数据索引index</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、利用pandas查询数据"><span class="nav-number">4.</span> <span class="nav-text">四、利用pandas查询数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、统计分析"><span class="nav-number">5.</span> <span class="nav-text">五、统计分析</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chenwi</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
